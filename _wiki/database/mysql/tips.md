---
layout  : wiki
title   : MySQL 이것저것
summary : 
date    : 2022-12-19 20:45:26 +0900
updated : 2022-12-19 21:34:53 +0900
tag     : db
toc     : true
public  : true
parent  : [[/database/mysql]]
latex   : false
resource: E233A812-74FF-4210-A050-DF5B73DAD6C2
---
* TOC
{:toc}

## identifier column

- 식별자 컬럼은 가급적이면 정수 타입을 사용할 것. `AUTO_INCREMENT`가 된다는 장점도 있다.
- 문자열 타입은 가급적 사용하지 말 것. 정수 타입보다 느리다.

만약 굳이 문자열 타입을 식별자로 사용해야 한다면, 해시값이나 UUID 처럼 랜덤한 문자열을 사용하는 경우를 주의할 것.

>
또한 `MD5()`, `SHA1()` 또는 `UUID()`에 의해 생성된 문자열과 같이 완전히 '임의의' 문자열에 대해서도 매우 주의해야 합니다.
생성한 각각의 새로운 값은 큰 공간에 임의의 방식으로 배포되므로 `INSERT` 및 일부 `SELECT` 쿼리가 느려질 수 있습니다.[^original-164]
>
> - 삽입된 값이 인덱스의 임의의 위치에 있어야 하기 때문에 `INSERT` 쿼리가 느려집니다. 이로 인해 클러스터형 저장소 엔진에 대한 페이지 분할, 임의의 디스크 액세스 및 클러스터형 인덱스 조각화가 발생합니다.
> - 논리적으로는 인접한 행이 디스크와 메모리에 광범위하게 분산되기 때문에 `SELECT` 쿼리가 느려집니다.
> - 랜덤값은 캐싱이 작동하는 방식인 참조 인접성을 무효화하기 때문에 모든 유형의 쿼리에 대해 캐시 성능이 저하됩니다. 전체 데이터 세트가 동일하게 '핫'하다면 데이터의 특정 부분을 메모리에 캐시하는 이점이 없고 작업 세트가 메모리에 맞지 않으면 캐시에 많은 플러시와 누락이 발생합니다.
>
UUID(Universally Unique Identifier) 값을 저장하는 경우 대시를 제거하거나 `UNHEX()`를 사용 하여 UUID 값을 16바이트 숫자로 변환하고 `BINARY(16)` 열에 저장해야 합니다. `HEX()` 함수를 사 용하여 16진수 형식으로 값을 검색할 수 있습니다.
>
-- MySQL 성능 최적화. 6장. 164쪽.

## 가급적 NOT NULL을 사용할 것

>
관련 항목에서 MySQL은 인덱스에 값이 아닌 것을 포함하지 않는 Oracle과 달리 `NULL`을 인덱싱합니다.
>
-- MySQL 성능 최적화. 6장. 167쪽.

<span/>

>
많은 테이블에는 애플리케이션이 `NULL`을 저장할 필요가 없는 경우에도 단지 기본값이기 때문에 `NULL`이 가능한 열이 포함됩니다.
`NULL`을 저장할 의도가 아니라면 일반적으로 열을 `NOT NULL`로 지정하는 것이 가장 좋습니다.
MySQL은 인덱스, 인덱스 통계 및 값 비교를 복잡하게 만들기 때문에 `NULL` 가능 열을 참조하는 쿼리는 최적화하기가 어렵습니다.
`NULL` 가능한 열은 더 많은 스토리지 공간을 사용하며 MySQL 내부에서 특별한 처리가 필요합니다. `NULL` 열을 `NOT NULL`로 변경해서 얻는 성능 향상이 크지는 않으므로 그것들이 문제를 일으키는 지 아닌지를 모른다면 기존 스키마에서 해당 열을 일일이 찾아 변경하는 것은 꼭 할 필요는 없습니다.
>
-- MySQL 성능 최적화. 6장. 144쪽.

- nullable과 not null 컬럼은 미세한 성능 차이가 있다.
    - 그러나 엄청난 차이는 아니므로 nullable을 찾아 일일이 바꾸는 작업을 굳이 하지는 말 것.
- `NULL` 대신 적절한 default 값을 고려해볼 것.
- 그러나 그럼에도 불구하고 여러가지를 고려했을 때 `NULL`이 적절하다면 그냥 `NULL`을 사용한다.



## 참고문헌

- MySQL 성능 최적화 / 실비아 보트로스, 제레미 틴리 저/류수미, 송희정 역 / 위키북스 / 초판발행 2022년 09월 22일 /  원제 : High Performance MySQL 4E

## 주석

[^original-164]: 원주: 반면에 작성자가 많은 아주 큰 일부 테이블의 경우, 이러한 의사 난수 값은 실제로 '핫스팟'을 제거하는 데 도움이 될 수 있습니다.

