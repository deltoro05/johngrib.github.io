---
layout  : wiki
title   : (백업) 아름다운 Vㅏㅁ 2022년 4월 8일
summary : ctags 이야기
date    : 2022-12-28 15:17:32 +0900
updated : 2022-12-28 15:28:02 +0900
tag     : vim
resource: AD/0EF20F-6542-415D-BE97-143CBDC75373
toc     : true
public  : true
parent  : [[/article]]
latex   : false
---
* TOC
{:toc}

>
이 글은 2022년 4월 8일 트위터에 쓴 글을 백업한 것입니다.
{:style="background-color: #fff9e4;"}

<blockquote class="twitter-tweet"><p lang="ko" dir="ltr">앗차. 오늘도<br>Vㅏ<br>ㅁ이 되었군요...</p>&mdash; John Grib (@John_Grib) <a href="https://twitter.com/John_Grib/status/1512430415599976453?ref_src=twsrc%5Etfw">April 8, 2022</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

- [unroll link]( https://threadreaderapp.com/thread/1512430415599976453.html )

## tags 파일과 vim

앗차. 오늘도  
Vㅏ  
ㅁ이 되었군요...

오늘은 tags 파일 이야기를 해보죠. 이건 아는 사람은 알고, 모르는 사람은 모르는 물건인데(당연한 이야기를 하고 있다), ctags 라는 프로그램이 만들어 주는 일종의 인덱싱 파일입니다.

![ctags의 man 페이지]( /resource/AD/0EF20F-6542-415D-BE97-143CBDC75373/FP075U9VUAMyoqy.jpg )

man 페이지를 읽어보면 프로그래밍 언어별로 인덱스 파일을 만들어주는 프로그램이라는 것을 알 수 있습니다. IntelliJ 라던가 Eclipse 같은 IDE를 쓰다보면 늘 인덱스를 갱신하고 있죠. 그렇게 갱신한 인덱스는 프로젝트의 각 함수나 클래스, 상수, 변수 같은 것들의 이름과 위치를 저장해 놓고 자동완성이라던가, jump to definition 이라던가, rename 같은 리팩토링 도구라던가 하는 곳에 사용합니다.

그래서 이런 인덱싱 처리는 코딩할 때 꽤나 중요한 지원 기능이고, vim에서는 이 기능이 자동으로 동작하지 않기 때문에 vim에서 간단한 코딩은 해내는 사람도 프로젝트 단위의 개발은 
어떻게 해야 할 지 감을 잡지 못하는 사람들도 있습니다. vim에서는 jump to definition도 안 되고, rename 기능도 없고 하니까 익숙한 IDE로 돌아가곤 하는 거죠. 그래서 ctags를 사용(설정)할 줄 아는 건 vim을 IDE 대용으로 사용할 수 있는지 없는지를 가르는 중요한 조 건 중의 하나가 됩니다.
 
한편 vim에는 jump to the definition 기능이 이미 들어있습니다. `<c-]>` 로 사용할 수 있죠. 제가 ctags 없이 vim을 안 쓴 적이 너무 예전이라 기억이 잘 안 나긴 하는데, 아마 간단한 점프는 될 겁니다.
그리고 이 기능은 ctags로 만든 인덱스 파일인 `tags`가 있을 때 더 잘 사용할 수 있습니다.

![vim의 help]( /resource/AD/0EF20F-6542-415D-BE97-143CBDC75373/FP095-QVUAMmOQX.jpg )

한편 ctags는 평범한 터미널 명령이기도 해서 vim과 무관하게 그냥 실행할 수도 있습니다. 한번 실제로 코딩을 한 다음에 ctags로 인덱스 파일을 만들어 보죠.

간단한 자바스크립트 파일을 하나 만들었습니다. 상수가 하나 있고, 함수가 두 개 있습니다. 코딩은 vim 코파일럿이 했습니다.

![간단한 자바스크립트 파일]( /resource/AD/0EF20F-6542-415D-BE97-143CBDC75373/FP0-_lFVUAQyJNu.png )

이제 터미널로 나가서 `ctags *.js`를 입력하면 `tags`라는 파일이 생성됩니다. 내용을 볼까요?

제일 마지막 3줄을 보면 함수와 상수 이름들이 있는 것을 알 수 있습니다.

![tags 파일의 내용]( /resource/AD/0EF20F-6542-415D-BE97-143CBDC75373/FP0_aIvVkAEVIB8.jpg )

이게 있으면 vim이 상수 이름과 상수 이름 등을 구조적으로 파악하게 됩니다. 이걸 이용하는 vim 플러그인들도 많죠. 스샷은 유명한 vim 플러그인인 tagbar를 열어본 것입니다. IDE도 이런 기능들이 하나의 애플리케이션에 통합되어 있다 뿐이지, 동작하는 방식은 크게 다르지 않습니다.

![vim에서 tagbar를 열어본 모습]( /resource/AD/0EF20F-6542-415D-BE97-143CBDC75373/FP0_6jZXIAU0Uho.jpg )

그래서 vim으로 이런 저런 작업을 하다 보면 좀 고생스럽긴 하지만 나만의 IDE를 (처절하게) 조립하며 만들어가는 기분이 들기도 합니다. 좀 힘들긴 한데 재밌어요. 뭐하러 그렇게까지 하면서 vim을 쓰냐고 하면 사실 할 말은 없지만.. 오락하는데 이유가 어딨냐는 원사운드 만화 한 컷이 생각나네요.

![원사운드 만화의 한 장면]( /resource/AD/0EF20F-6542-415D-BE97-143CBDC75373/FP1Ak0ZVsAQqfox.png )

객관적으로 돌이켜보면 동기는 다분히 감정적이었습니다. 그냥 vim이 익숙하고, vim의 사용이 재미있고, vim을 쓸 때마다 느끼는 vim의 철학이 좋아서 그냥 이거로 다 해보겠다 하는 거죠.
옛날 플레이스테이션1,2 시절 메탈기어 솔리드할 때 아무도 안 죽이고 끝판까지 깨기 그런거 다들 해봤잖아요.

## ctags

아무튼 `ctags` 이야기로 돌아가서, `ctags`를 쓸 때 신경써야 할 것이 몇 가지 있습니다.

1. 어떤 ctags를 쓸 것인가? 나는 어떤 프로그래밍 언어를 쓰는가?
2. 인덱스를 어떻게 갱신할 것인가?
3. 어떤 에디터에서 쓸 것인가? 

`ctags`는 1990년대 초반에 나온 오래된 프로그램이기도 하고, 용도별로 개선해 만들어진 다른 ctags들도 있어서 어떤 것을 쓰는지 결정하는 건 꽤나 중요한 일입니다.
예를 들어 go 언어를 위한 `gotags`라는 것도 따로 있어요. 한편 이 ctags의 개발자는 켄 아놀드인데, 이 분도 자바와 관련이 있습니다.
제임스 고슬링과 함께 Java 프로그래밍 언어 책의 저자이기도 했죠.

![The Java Programming Language]( /resource/AD/0EF20F-6542-415D-BE97-143CBDC75373/FP1DhqIVkAE2yl0.jpg )

그런데 말입니다.

이 분이 개발한 프로그램 중에 정말 유명한 건 rogue 라는 이름의 게임입니다. 네 그거 맞습니다. rogue like 장르의 시초가 된 그 게임.

아무튼 저는 게임에 대해서는 잘 모르고, 켄 아놀드에 대해서는 이 정도 밖에 모릅니다. 다시 `ctags`로 돌아가서, 제가 아는 ctags는 네 종류가 있습니다. 그냥 ctags, Exuberant ctags, Universal ctags, 그리고 언어별로 특별히 만들어진 다양한 ctags 들.

너무 좋은 vim 책인 practical vim 16장에서는 Exuberant Ctags의 사용법을 소개합니다. 저는 Universal ctags를 사용하고 있고요.
어느 쪽을 선택하건 상관없는데 Universal ctags가 좀 더 많은 프로그래밍 언어를 커버하고 있어서 이쪽을 쓰고 있습니다.

[[/ctags]]

이제 2번 질문으로 돌아가죠. `ctags` 인덱스 파일을 어떻게 갱신할 것인가? 입니다.
인덱스 파일은 자동으로 갱신되는 게 가장 좋습니다.
하지만 vim 자체는 `ctags`의 결과물인 `tags` 파일의 자동 갱신 기능이 없어요.
그래서 `ctags`를 매번 수동으로 실행하거나 vim 세이브 오토 커맨드로 해결하거나 해야 하는데, 문제는 이게 귀찮고 대상 파일이 많으면 골치아프다는 것입니다.
그래서 대안으로 나온 플러그인들이 vim에서 파일을 저장할 때마다 `git status`를 참고해서 변경된 파일들만 인덱스를 갱신해주는 것들입니다.
오! 이걸 쓰면 IDE랑 비슷한 느낌... 경우에 따라서는 더 빠른 느낌입니다.

이런 플러그인들은 꽤 여럿이 있는 것 같은데 저는 계속 바꿔가면서 다양하게 써보다가 몇 년 전에 vim-gutentags 가 가장 별 탈 없이 빠르게 잘 돌아가서 그 이후로 아예 ctags 인덱스에 관심을 끊고 이것만 쓰고 있습니다.
구텐탁이라니 이름이 참 귀엽지 않나요.

<https://github.com/ludovicchabant/vim-gutentags >

그러면 세 번째 질문으로 돌아가죠. 어떤 에디터에서 쓸 것인가? 앗 당연히 vim이 아닌가? 라고 생각하실 수도 있을 겁니다. 그런데 vim도 그렇고 ctags도 그렇고 따지고 보면 유닉스 철학을 따르려 하는 평범한 터미널 cli 프로그램들입니다. 이 녀석들은 자신의 기능만 충실하면 됩니다.

그래서 vim이 아닌 다른 멋있는 에디터를 만들었다거나, 발견했을때 프로그래밍 언어의 키워드 식별 기능이 필요하다면 ctags가 자동으로 가동되도록 설정을 하거나 하면 IDE 비스무리하게 사용할 수 있을 겁니다. 저는 이런 도구들을 엮어서 쓰는 게 참 재밌더라고요. 맥가이버 음악 들리는 거 같고.

`tags` 파일은 인덱싱의 역할만 잘 해내고 있기 때문에 이걸 쓰는 vim 플러그인들도 상당히 많습니다.
자동완성 플러그인은 물론이고, 코드 점프, 리팩토링 도구, 코드 엿보기 팝업 띄우는 플러그인 등등... 필요하다면 직접 만들 수도 있고요. 이런 것들을 찾아가며 하나하나 실험해보는 것도 즐겁죠.

오늘은 여기까지 하죠. 아름다운  
Vㅏ  
ㅁ 입니다.

